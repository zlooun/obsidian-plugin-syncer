/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __publicField = (obj, key, value) => __defNormalProp(obj, typeof key !== "symbol" ? key + "" : key, value);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => YandexDiskBackupPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
function* stateGenerator(states) {
  let i = 0;
  while (true) {
    yield states[i++ % states.length];
  }
}
var YandexDiskBackupPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    __publicField(this, "statusEl");
    __publicField(this, "state", { kind: "idle" });
  }
  async onload() {
    this.statusEl = this.addStatusBarItem();
    this.statusEl.addClass("syncer-status");
    const states = stateGenerator([
      { kind: "idle" },
      { kind: "dirty", changed: 25 },
      { kind: "scanning" },
      { kind: "syncing", done: 25, total: 100 },
      { kind: "syncing", done: 43, total: 100 },
      { kind: "syncing", done: 69, total: 100 },
      { kind: "syncing", done: 100, total: 100 },
      { kind: "ok", lastSyncAt: +/* @__PURE__ */ new Date() },
      { kind: "error", message: "\u0412\u043E\u0442 \u0442\u0430\u043A \u0432\u043E\u0442\u0430" }
    ]);
    this.statusEl.onclick = () => {
      new import_obsidian.Notice("Syncer: clicked");
      this.setState(states.next().value);
    };
    this.renderStatus();
    this.addRibbonIcon("refresh-cw", "Syncer", () => {
      new import_obsidian.Notice("Hello, world!");
    });
  }
  setState(next) {
    this.state = next;
    this.renderStatus();
  }
  renderStatus() {
    this.statusEl.empty();
    const icon = this.statusEl.createSpan({ cls: "syncer-icon" });
    const text = this.statusEl.createSpan({ cls: "syncer-text" });
    switch (this.state.kind) {
      case "idle":
        (0, import_obsidian.setIcon)(icon, "cloud");
        text.setText("Syncer");
        this.statusEl.title = "Syncer: idle";
        break;
      case "dirty":
        (0, import_obsidian.setIcon)(icon, "cloud-alert");
        text.setText(`Syncer: ${this.state.changed}`);
        this.statusEl.title = `Syncer: ${this.state.changed} changed (not synced)`;
        break;
      case "scanning":
        (0, import_obsidian.setIcon)(icon, "search");
        text.setText("Syncer: scan");
        this.statusEl.title = "Syncer: scanning vault";
        break;
      case "syncing":
        (0, import_obsidian.setIcon)(icon, "cloud-upload");
        if (this.state.total != null && this.state.done != null) {
          text.setText(`Syncer: ${this.state.done}/${this.state.total}`);
          this.statusEl.title = `Syncer: uploading ${this.state.done}/${this.state.total}`;
        } else {
          text.setText("Syncer: sync");
          this.statusEl.title = "Syncer: syncing";
        }
        break;
      case "ok":
        (0, import_obsidian.setIcon)(icon, "cloud-check");
        text.setText("Syncer: ok");
        this.statusEl.title = `Syncer: last sync ${new Date(this.state.lastSyncAt).toLocaleString()}`;
        break;
      case "error":
        (0, import_obsidian.setIcon)(icon, "cloud-off");
        text.setText("Syncer: !");
        this.statusEl.title = `Syncer error: ${this.state.message}`;
        break;
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IFBsdWdpbiwgTm90aWNlLCBzZXRJY29uIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG50eXBlIFN5bmNTdGF0ZSA9XG4gIHwgeyBraW5kOiAnaWRsZScgfVxuICB8IHsga2luZDogJ2RpcnR5JzsgY2hhbmdlZDogbnVtYmVyIH1cbiAgfCB7IGtpbmQ6ICdzY2FubmluZycgfVxuICB8IHsga2luZDogJ3N5bmNpbmcnOyBkb25lPzogbnVtYmVyOyB0b3RhbD86IG51bWJlciB9XG4gIHwgeyBraW5kOiAnb2snOyBsYXN0U3luY0F0OiBudW1iZXIgfVxuICB8IHsga2luZDogJ2Vycm9yJzsgbWVzc2FnZTogc3RyaW5nIH07XG5cbmZ1bmN0aW9uKiBzdGF0ZUdlbmVyYXRvcihzdGF0ZXM6IFN5bmNTdGF0ZVtdKSB7XG4gIGxldCBpID0gMDtcbiAgd2hpbGUgKHRydWUpIHtcbiAgICB5aWVsZCBzdGF0ZXNbaSsrICUgc3RhdGVzLmxlbmd0aF07XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgWWFuZGV4RGlza0JhY2t1cFBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gIHByaXZhdGUgc3RhdHVzRWwhOiBIVE1MRWxlbWVudDtcbiAgcHJpdmF0ZSBzdGF0ZTogU3luY1N0YXRlID0geyBraW5kOiAnaWRsZScgfTtcblxuICBhc3luYyBvbmxvYWQoKSB7XG4gICAgdGhpcy5zdGF0dXNFbCA9IHRoaXMuYWRkU3RhdHVzQmFySXRlbSgpO1xuICAgIHRoaXMuc3RhdHVzRWwuYWRkQ2xhc3MoJ3N5bmNlci1zdGF0dXMnKTtcblxuICAgIGNvbnN0IHN0YXRlcyA9IHN0YXRlR2VuZXJhdG9yKFtcbiAgICAgIHsga2luZDogJ2lkbGUnIH0sXG4gICAgICB7IGtpbmQ6ICdkaXJ0eScsIGNoYW5nZWQ6IDI1IH0sXG4gICAgICB7IGtpbmQ6ICdzY2FubmluZycgfSxcbiAgICAgIHsga2luZDogJ3N5bmNpbmcnLCBkb25lOiAyNSwgdG90YWw6IDEwMCB9LFxuICAgICAgeyBraW5kOiAnc3luY2luZycsIGRvbmU6IDQzLCB0b3RhbDogMTAwIH0sXG4gICAgICB7IGtpbmQ6ICdzeW5jaW5nJywgZG9uZTogNjksIHRvdGFsOiAxMDAgfSxcbiAgICAgIHsga2luZDogJ3N5bmNpbmcnLCBkb25lOiAxMDAsIHRvdGFsOiAxMDAgfSxcbiAgICAgIHsga2luZDogJ29rJywgbGFzdFN5bmNBdDogK25ldyBEYXRlKCkgfSxcbiAgICAgIHsga2luZDogJ2Vycm9yJywgbWVzc2FnZTogJ1x1MDQxMlx1MDQzRVx1MDQ0MiBcdTA0NDJcdTA0MzBcdTA0M0EgXHUwNDMyXHUwNDNFXHUwNDQyXHUwNDMwJyB9LFxuICAgIF0pO1xuXG4gICAgdGhpcy5zdGF0dXNFbC5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgLy8gXHUwNDNEXHUwNDMwXHUwNDNGXHUwNDQwXHUwNDM4XHUwNDNDXHUwNDM1XHUwNDQwOiBcdTA0MzVcdTA0NDFcdTA0M0JcdTA0MzggXHUwNDNFXHUwNDQ4XHUwNDM4XHUwNDMxXHUwNDNBXHUwNDMwIFx1MjAxNCBcdTA0M0ZcdTA0M0VcdTA0M0FcdTA0MzBcdTA0MzdcdTA0MzBcdTA0NDJcdTA0NEMsIFx1MDQzNVx1MDQ0MVx1MDQzQlx1MDQzOCBkaXJ0eSBcdTIwMTQgXHUwNDM3XHUwNDMwXHUwNDNGXHUwNDQzXHUwNDQxXHUwNDQyXHUwNDM4XHUwNDQyXHUwNDRDIHN5bmMsIFx1MDQzOFx1MDQzRFx1MDQzMFx1MDQ0N1x1MDQzNSBcdTA0M0ZcdTA0M0VcdTA0M0FcdTA0MzBcdTA0MzdcdTA0MzBcdTA0NDJcdTA0NEMgZGlmZlxuICAgICAgbmV3IE5vdGljZSgnU3luY2VyOiBjbGlja2VkJyk7XG5cbiAgICAgIHRoaXMuc2V0U3RhdGUoc3RhdGVzLm5leHQoKS52YWx1ZSEpO1xuICAgIH07XG5cbiAgICB0aGlzLnJlbmRlclN0YXR1cygpO1xuXG4gICAgdGhpcy5hZGRSaWJib25JY29uKCdyZWZyZXNoLWN3JywgJ1N5bmNlcicsICgpID0+IHtcbiAgICAgIG5ldyBOb3RpY2UoJ0hlbGxvLCB3b3JsZCEnKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgc2V0U3RhdGUobmV4dDogU3luY1N0YXRlKSB7XG4gICAgdGhpcy5zdGF0ZSA9IG5leHQ7XG4gICAgdGhpcy5yZW5kZXJTdGF0dXMoKTtcbiAgfVxuXG4gIHByaXZhdGUgcmVuZGVyU3RhdHVzKCkge1xuICAgIC8vIFx1MDQzRVx1MDQ0N1x1MDQzOFx1MDQ0OVx1MDQzMFx1MDQzNVx1MDQzQ1xuICAgIHRoaXMuc3RhdHVzRWwuZW1wdHkoKTtcblxuICAgIGNvbnN0IGljb24gPSB0aGlzLnN0YXR1c0VsLmNyZWF0ZVNwYW4oeyBjbHM6ICdzeW5jZXItaWNvbicgfSk7XG4gICAgY29uc3QgdGV4dCA9IHRoaXMuc3RhdHVzRWwuY3JlYXRlU3Bhbih7IGNsczogJ3N5bmNlci10ZXh0JyB9KTtcblxuICAgIHN3aXRjaCAodGhpcy5zdGF0ZS5raW5kKSB7XG4gICAgICBjYXNlICdpZGxlJzpcbiAgICAgICAgc2V0SWNvbihpY29uLCAnY2xvdWQnKTtcbiAgICAgICAgdGV4dC5zZXRUZXh0KCdTeW5jZXInKTtcbiAgICAgICAgdGhpcy5zdGF0dXNFbC50aXRsZSA9ICdTeW5jZXI6IGlkbGUnO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnZGlydHknOlxuICAgICAgICBzZXRJY29uKGljb24sICdjbG91ZC1hbGVydCcpO1xuICAgICAgICB0ZXh0LnNldFRleHQoYFN5bmNlcjogJHt0aGlzLnN0YXRlLmNoYW5nZWR9YCk7XG4gICAgICAgIHRoaXMuc3RhdHVzRWwudGl0bGUgPSBgU3luY2VyOiAke3RoaXMuc3RhdGUuY2hhbmdlZH0gY2hhbmdlZCAobm90IHN5bmNlZClgO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSAnc2Nhbm5pbmcnOlxuICAgICAgICBzZXRJY29uKGljb24sICdzZWFyY2gnKTtcbiAgICAgICAgdGV4dC5zZXRUZXh0KCdTeW5jZXI6IHNjYW4nKTtcbiAgICAgICAgdGhpcy5zdGF0dXNFbC50aXRsZSA9ICdTeW5jZXI6IHNjYW5uaW5nIHZhdWx0JztcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgJ3N5bmNpbmcnOlxuICAgICAgICBzZXRJY29uKGljb24sICdjbG91ZC11cGxvYWQnKTtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUudG90YWwgIT0gbnVsbCAmJiB0aGlzLnN0YXRlLmRvbmUgIT0gbnVsbCkge1xuICAgICAgICAgIHRleHQuc2V0VGV4dChgU3luY2VyOiAke3RoaXMuc3RhdGUuZG9uZX0vJHt0aGlzLnN0YXRlLnRvdGFsfWApO1xuICAgICAgICAgIHRoaXMuc3RhdHVzRWwudGl0bGUgPSBgU3luY2VyOiB1cGxvYWRpbmcgJHt0aGlzLnN0YXRlLmRvbmV9LyR7dGhpcy5zdGF0ZS50b3RhbH1gO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRleHQuc2V0VGV4dCgnU3luY2VyOiBzeW5jJyk7XG4gICAgICAgICAgdGhpcy5zdGF0dXNFbC50aXRsZSA9ICdTeW5jZXI6IHN5bmNpbmcnO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdvayc6XG4gICAgICAgIHNldEljb24oaWNvbiwgJ2Nsb3VkLWNoZWNrJyk7XG4gICAgICAgIHRleHQuc2V0VGV4dCgnU3luY2VyOiBvaycpO1xuICAgICAgICB0aGlzLnN0YXR1c0VsLnRpdGxlID0gYFN5bmNlcjogbGFzdCBzeW5jICR7bmV3IERhdGUodGhpcy5zdGF0ZS5sYXN0U3luY0F0KS50b0xvY2FsZVN0cmluZygpfWA7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlICdlcnJvcic6XG4gICAgICAgIHNldEljb24oaWNvbiwgJ2Nsb3VkLW9mZicpO1xuICAgICAgICB0ZXh0LnNldFRleHQoJ1N5bmNlcjogIScpO1xuICAgICAgICB0aGlzLnN0YXR1c0VsLnRpdGxlID0gYFN5bmNlciBlcnJvcjogJHt0aGlz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
